{
    "handler": {
        "type": "Chain",
        "config": {
            "filters": [{
                "type": "ScriptableFilter",
                "config": {
                    "type": "application/x-groovy",
                    "file": "generate_sso_token.groovy"
                }
            }, {
                "type": "ScriptableFilter",
                "config": {
                    "type": "application/x-groovy",
                    "file": "display_if_403.groovy"
                }
            }, {
                "type": "PolicyEnforcementFilter",
                "config": {
                    "openamUrl": "${readProperties(system['user.home'].concat('/openig.properties'))['openamUrl']}",
                    "pepUsername": "amadmin",
                    "pepPassword": "secret12",
                    "application": "${readProperties(system['user.home'].concat('/openig.properties'))['applicationName']}",
                    "ssoTokenSubject": "${request.cookies['iPlanetDirectoryPro'][0].value}",
                    "target": "${attributes.myPolicyDecision}",
                    "environment": {
                        "DAY_OF_WEEK": [
                            "Saturday"
                        ]
                    },
                    "cacheMaxExpiration": "5 seconds"
                }
            }],
            "handler": {
                "type": "ScriptableHandler",
                "config": {
                    "type": "application/x-groovy",
                    "file": "protected_resource.groovy"
                }
            }
        }
    },
    "condition": "${matches(request.uri.path, '/pep-advices')}"
}
